# ğŸ©º Diabetes Companion V1

> **AI-Powered Daily Diabetes Management App**  
> Full-stack Next.js + Express application with Supabase PostgreSQL

---

## ğŸ“ **Project Structure**

```
diabetes-companion-v1/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/              # Next.js frontend (:3000)
â”‚   â””â”€â”€ api/              # Express backend (:4000)
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ db/               # Database schema & migrations
â”œâ”€â”€ docs/                 # Documentation
â”œâ”€â”€ .git/                 # Git repository
â””â”€â”€ package.json          # Root workspace config
```

---

## ğŸ¯ **Tech Stack**

### **Frontend** (`apps/web`)
- **Framework**: Next.js 16.1.1 (App Router)
- **UI**: React 19, TypeScript
- **Styling**: TailwindCSS v4
- **Port**: `3000`

### **Backend** (`apps/api`)
- **Framework**: Express.js
- **Database**: Supabase PostgreSQL
- **Port**: `4000`
- **Schema**: `glucose_readings` table

### **Database** (`packages/db`)
- **Primary Table**: `glucose_readings`
- **Fields**: `id`, `glucose_mgdl`, `measured_at`, `notes`, `meal_tag`

---

## ğŸš€ **Quick Start**

### **Prerequisites**
- Node.js >= 20
- Supabase account
- Git

### **1. Clone & Install**
```bash
git clone <your-repo>
cd diabetes-companion-v1
npm install
```

### **2. Configure Backend**
```bash
cd apps/api
cp .env.example .env
# Edit .env and add your Supabase DATABASE_URL
```

### **3. Create Database Table**
In Supabase SQL Editor, run:
```sql
-- See packages/db/schema.sql for full schema
CREATE TABLE glucose_readings (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  glucose_mgdl INTEGER NOT NULL,
  measured_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  notes TEXT,
  meal_tag TEXT
);

CREATE INDEX idx_glucose_measured_at ON glucose_readings(measured_at DESC);
```

### **4. Start Development**
From root directory:
```bash
# Start both frontend + backend
npm run dev

# Or start individually:
npm run dev:api    # Backend only (:4000)
npm run dev:web    # Frontend only (:3000)
```

### **5. Verify**
- Frontend: [http://localhost:3000](http://localhost:3000)
- Backend health: [http://localhost:4000/health](http://localhost:4000/health)

---

## ğŸ“¡ **API Endpoints**

### **Health Check**
```
GET /health
```

### **Glucose Readings**
```
POST   /api/glucose       # Create reading
GET    /api/glucose       # Get readings (limit=50)
DELETE /api/glucose/:id   # Delete reading
```

**Example Request (POST /api/glucose)**:
```json
{
  "glucose_mgdl": 120,
  "measured_at": "2026-01-18T10:30:00Z",
  "notes": "Before breakfast",
  "meal_tag": "fasting"
}
```

---

## ğŸ¨ **Features (V1)**

### **Core Functionality**
- âœ… Glucose reading logging (mg/dL)
- âœ… Timestamped entries with notes
- âœ… Meal tagging system
- ğŸš§ Daily summaries view
- ğŸš§ AI-powered insights (OpenAI integration)
- ğŸš§ Trend visualization
- ğŸš§ Export data

### **Architecture Decisions**
- **Port Separation**: Frontend (3000) + Backend (4000)
- **Canonical Table**: `glucose_readings` (not `glucose_logs`)
- **Monorepo**: npm workspaces for unified development
- **CORS**: Backend allows localhost:3000
- **Environment**: `.env.local` (web) + `.env` (api)

---

## ğŸ“ **Package Scripts**

Run from **root directory**:

| Command | Description |
|---------|-------------|
| `npm run dev` | Start both apps (recommended) |
| `npm run dev:web` | Frontend only |
| `npm run dev:api` | Backend only |
| `npm run build:web` | Build production frontend |
| `npm run start:api` | Start production backend |

---

## ğŸ” **Environment Variables**

### **Frontend** (`apps/web/.env.local`)
```bash
NEXT_PUBLIC_API_BASE_URL=http://localhost:4000
```

### **Backend** (`apps/api/.env`)
```bash
PORT=4000
DATABASE_URL=postgresql://postgres.[ref]:[password]@[region].pooler.supabase.com:5432/postgres
PGSSLMODE=require
```

---

## ğŸ§ª **Testing API Locally**

```bash
# Health check
curl http://localhost:4000/health

# Create glucose reading
curl -X POST http://localhost:4000/api/glucose \
  -H "Content-Type: application/json" \
  -d '{"glucose_mgdl": 95, "notes": "Feeling good"}'

# Get recent readings
curl http://localhost:4000/api/glucose?limit=10
```

---

## ğŸ“š **Documentation**

- **Backend API**: See `apps/api/README.md`
- **Database Schema**: See `packages/db/schema.sql`
- **Frontend Guide**: See `apps/web/README.md` (coming soon)

---

## ğŸš¢ **Deployment**

### **Backend** (Render)
1. Push to GitHub
2. Create Web Service on Render
3. Set build command: `npm install`
4. Set start command: `node src/server.js`
5. Add environment variables from `apps/api/.env.example`

### **Frontend** (Vercel)
1. Connect GitHub repo
2. Set root directory: `apps/web`
3. Framework preset: Next.js
4. Add `NEXT_PUBLIC_API_BASE_URL` pointing to your Render backend

---

## ğŸ¯ **Next Steps**

1. âœ… **Structure normalized** (you are here)
2. ğŸ”œ Build frontend UI (logging page, dashboard)
3. ğŸ”œ Add AI summary generation (OpenAI)
4. ğŸ”œ Implement data visualization
5. ğŸ”œ Deploy to production

---

## ğŸ‘¤ **Author**

Built with â¤ï¸ for better diabetes management

---

## ğŸ“ **License**

MIT
